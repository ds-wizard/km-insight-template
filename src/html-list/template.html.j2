{%- set km = ctx.knowledgeModel -%}
{%- set pkg = ctx.package -%}
{%- macro renderAnswer(answer) %}
    <li text="answer" id="{{answer.uuid}}">
      <div>[A] {{answer.label|e}} <small><code>{{answer.uuid}}</code></small></div>
    <ol>
{%- for questionUuid in answer.followUpUuids %}
  {{ renderQuestion(km.entities.questions[questionUuid]) }}
{%- endfor %}
    </ol>
    </li>
{%- endmacro -%}
{%- macro renderQuestion(question) %}
{%- set qtype = "string" %}
{%- if question.questionType == "OptionsQuestion" %}
{%- set qtype = "options" %}
{%- elif question.questionType == "ListQuestion" %}
{%- set qtype = "list" %}
{%- elif question.questionType == "ValueQuestion" %}
  {%- if question.valueType == "TextQuestionValueType" %}
    {%- set qtype = "text" %}
  {%- elif question.valueType == "DateQuestionValueType" %}
    {%- set qtype = "date" %}
  {%- elif question.valueType == "NumberQuestionValueType" %}
    {%- set qtype = "number" %}
  {%- endif %}
{%- elif question.questionType == "IntegrationQuestion" %}
{%- set qtype = "integration" %}
{%- endif %}
    <li text="question" id="{{question.uuid}}">
      <div>[Q][{{qtype}}] {{question.title|e}} <small><code>{{question.uuid}}</code></small></div>
{%- if question.questionType == "OptionsQuestion" %}
<ol>
{%- for answerUuid in question.answerUuids %}
  {{ renderAnswer(km.entities.answers[answerUuid]) }}
{%- endfor %}
</ol>
{%- elif question.questionType == "ListQuestion" %}
<ol>
{%- for questionUuid in question.itemTemplateQuestionUuids %}
  {{ renderQuestion(km.entities.questions[questionUuid]) }}
{%- endfor %}
</ol>
{%- endif %}
    </li>
{%- endmacro -%}
{%- macro renderChapter(chapter) -%}
    <h2 class="chapter" id="{{chapter.uuid}}">{{chapter.title|e}} <small><code>{{chapter.uuid}}</code></small></h2>
    <ol>
    {%- for questionUuid in chapter.questionUuids %}
      {{ renderQuestion(km.entities.questions[questionUuid]) }}
    {%- endfor %}
    </ol>
{%- endmacro -%}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>DSW KM: {{pkg.name|e}}</title>
  </head>
  <body>
    <h1>{{pkg.name|e}} ({{pkg.id}})</h1>
    {%- for chapterUuid in km.chapterUuids %}
      {{ renderChapter(km.entities.chapters[chapterUuid]) }}
    {%- endfor %}
  </body>
</html>
